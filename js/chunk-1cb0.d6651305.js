(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cb0"],{"5c3d":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n("9dd0"),a=i(r);function i(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c={nFrequencyBars:255,onAnalysed:null},u=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,t),this.config=Object.assign({},c,n),this.audioContext=e,this.audioInput=null,this.realAudioInput=null,this.inputPoint=null,this.audioRecorder=null,this.rafID=null,this.analyserContext=null,this.recIndex=0,this.stream=null,this.updateAnalysers=this.updateAnalysers.bind(this)}return o(t,[{key:"init",value:function(t){var e=this;return new Promise(function(n){e.inputPoint=e.audioContext.createGain(),e.stream=t,e.realAudioInput=e.audioContext.createMediaStreamSource(t),e.audioInput=e.realAudioInput,e.audioInput.connect(e.inputPoint),e.analyserNode=e.audioContext.createAnalyser(),e.analyserNode.fftSize=2048,e.inputPoint.connect(e.analyserNode),e.audioRecorder=new a.default(e.inputPoint);var o=e.audioContext.createGain();o.gain.value=0,e.inputPoint.connect(o),o.connect(e.audioContext.destination),e.updateAnalysers(),n()})}},{key:"start",value:function(){var t=this;return new Promise(function(e,n){t.audioRecorder?(t.audioRecorder.clear(),t.audioRecorder.record(),e(t.stream)):n("Not currently recording")})}},{key:"stop",value:function(){var t=this;return new Promise(function(e){t.audioRecorder.stop(),t.audioRecorder.getBuffer(function(n){t.audioRecorder.exportWAV(function(t){return e({buffer:n,blob:t})})})})}},{key:"updateAnalysers",value:function(){if(this.config.onAnalysed){requestAnimationFrame(this.updateAnalysers);var t=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(t);for(var e=new Array(255),n=0,o=void 0,r=0;r<255;r+=1)o=Math.floor(t[r])-Math.floor(t[r])%5,0!==o&&(n=r),e[r]=o;this.config.onAnalysed({data:e,lineTo:n})}}},{key:"setOnAnalysed",value:function(t){this.config.onAnalysed=t}}]),t}();u.download=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio";a.default.forceDownload(t,e+".wav")},e.default=u},7283:function(t,e,n){"use strict";var o=n("b9e1"),r=n.n(o);r.a},"78fe":function(t,e,n){(function(e){var n=!!(e===e.window&&e.URL&&e.Blob&&e.Worker);function o(t,o){var r,a=this;if(o=o||{},n)return r=t.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],new e.Worker(e.URL.createObjectURL(new e.Blob([r],{type:"text/javascript"})));function i(t){setTimeout(function(){a.onmessage({data:t})},0)}this.self=o,this.self.postMessage=i,setTimeout(t.bind(o,o),0)}o.prototype.postMessage=function(t){var e=this;setTimeout(function(){e.self.onmessage({data:t})},0)},t.exports=o}).call(this,n("c8ba"))},"90de":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{color:"white py-5"}},[n("v-flex",{staticClass:"text-xs-center mb-5",attrs:{md12:""}},[n("v-btn",{staticClass:"recordicon",attrs:{fab:"",color:"error",size:"120",disabled:t.recordState},on:{click:function(e){t.startRecording()}}},[n("v-icon",{attrs:{size:"60"},domProps:{innerHTML:t._s("mic")}},[t._v("mdi-android")])],1),n("v-btn",{staticClass:"recordicon",attrs:{fab:"",color:"error",disabled:t.stopState},on:{click:function(e){t.stopRecording()}}},[n("v-icon",{attrs:{size:"60"},domProps:{innerHTML:t._s("mic_off")}},[t._v("mdi-android")])],1)],1),t.timer?n("v-flex",{staticClass:"text-xs-center mb-5",attrs:{md12:""}},[n("label",{attrs:{id:"minutes"}},[t._v("00")]),n("label",{attrs:{id:"colon"}},[t._v(":")]),n("label",{attrs:{id:"seconds"}},[t._v("00")])]):t._e(),t.stop?n("v-flex",{staticClass:"text-xs-center",attrs:{md12:""}},[n("div",{staticClass:"text-center"},[n("h2",[t._v("下載音檔")]),n("ul",{attrs:{id:"recordingslist"}})])]):t._e()],1)},r=[],a=n("c782"),i=n.n(a),s=new(window.AudioContext||window.webkitAudioContext),c=new i.a(s,{});navigator.mediaDevices.getUserMedia({audio:!0}).then(function(t){return c.init(t)}).catch(function(t){return console.log("Uh oh... unable to get stream...",t)});var u={data:function(){return{translate:[],recordState:!1,stopState:!0,timer:!0,stop:!1,isRecording:!1,blob:null}},created:function(){localStorage.setItem("t_text","")},mounted:function(){},methods:{startRecording:function(){var t=this;c.start().then(function(){return t.isRecording=!0}),this.recordState=!0,this.stopState=!1;var e=document.getElementById("minutes"),n=document.getElementById("seconds"),o=0;function r(){++o,n.innerHTML=a(o%60),e.innerHTML=a(parseInt(o/60))}function a(t){var e=t+"";return e.length<2?"0"+e:e}setInterval(r,1e3)},stopRecording:function(){var t=this;c.stop().then(function(e){var n=e.blob;e.buffer;t.blob=n,console.log("blob:"+t.blob);var o=document.getElementById("recordingslist"),r=URL.createObjectURL(t.blob);console.log("url:"+r);var a=document.createElement("li");console.log("li:"+a);var i=document.createElement("audio"),s=document.createElement("a");i.controls=!0,i.src=r,s.href=r,s.download=(new Date).toISOString()+".wav",s.innerHTML=s.download,a.appendChild(i),a.appendChild(s),o.appendChild(a)}),this.recordState=!0,this.stopState=!0,this.timer=!1,this.stop=!0,c.clear()}}},l=u,d=(n("7283"),n("2877")),f=Object(d["a"])(l,o,r,!1,null,null,null);f.options.__file="Record.vue";e["default"]=f.exports},"9dd0":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n("78fe"),a=i(r);function i(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c={bufferLen:4096,numChannels:2,mimeType:"audio/wav"},u=function(){function t(e,n){var o=this;s(this,t),this.config=Object.assign({},c,n),this.recording=!1,this.callbacks={getBuffer:[],exportWAV:[]},this.context=e.context,this.node=(this.context.createScriptProcessor||this.context.createJavaScriptNode).call(this.context,this.config.bufferLen,this.config.numChannels,this.config.numChannels),this.node.onaudioprocess=function(t){if(o.recording){for(var e=[],n=0;n<o.config.numChannels;n++)e.push(t.inputBuffer.getChannelData(n));o.worker.postMessage({command:"record",buffer:e})}},e.connect(this.node),this.node.connect(this.context.destination);var r={};this.worker=new a.default(function(){var t=0,e=[],n=void 0,o=void 0;function r(t){n=t.sampleRate,o=t.numChannels,u()}function a(n){for(var r=0;r<o;r++)e[r].push(n[r]);t+=n[0].length}function i(n){for(var r=[],a=0;a<o;a++)r.push(l(e[a],t));var i=void 0;i=2===o?d(r[0],r[1]):r[0];var s=p(i),c=new Blob([s],{type:n});this.postMessage({command:"exportWAV",data:c})}function s(){for(var n=[],r=0;r<o;r++)n.push(l(e[r],t));this.postMessage({command:"getBuffer",data:n})}function c(){t=0,e=[],u()}function u(){for(var t=0;t<o;t++)e[t]=[]}function l(t,e){for(var n=new Float32Array(e),o=0,r=0;r<t.length;r++)n.set(t[r],o),o+=t[r].length;return n}function d(t,e){var n=t.length+e.length,o=new Float32Array(n),r=0,a=0;while(r<n)o[r++]=t[a],o[r++]=e[a],a++;return o}function f(t,e,n){for(var o=0;o<n.length;o++,e+=2){var r=Math.max(-1,Math.min(1,n[o]));t.setInt16(e,r<0?32768*r:32767*r,!0)}}function h(t,e,n){for(var o=0;o<n.length;o+=1)t.setUint8(e+o,n.charCodeAt(o))}function p(t){var e=new ArrayBuffer(44+2*t.length),r=new DataView(e);return h(r,0,"RIFF"),r.setUint32(4,36+2*t.length,!0),h(r,8,"WAVE"),h(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,o,!0),r.setUint32(24,n,!0),r.setUint32(28,4*n,!0),r.setUint16(32,2*o,!0),r.setUint16(34,16,!0),h(r,36,"data"),r.setUint32(40,2*t.length,!0),f(r,44,t),r}this.onmessage=function(t){switch(t.data.command){case"init":r(t.data.config);break;case"record":a(t.data.buffer);break;case"exportWAV":i(t.data.type);break;case"getBuffer":s();break;case"clear":c();break}}},r),this.worker.postMessage({command:"init",config:{sampleRate:this.context.sampleRate,numChannels:this.config.numChannels}}),this.worker.onmessage=function(t){var e=o.callbacks[t.data.command].pop();"function"===typeof e&&e(t.data.data)}}return o(t,[{key:"record",value:function(){this.recording=!0}},{key:"stop",value:function(){this.recording=!1}},{key:"clear",value:function(){this.worker.postMessage({command:"clear"})}},{key:"getBuffer",value:function(t){if(t=t||this.config.callback,!t)throw new Error("Callback not set");this.callbacks.getBuffer.push(t),this.worker.postMessage({command:"getBuffer"})}},{key:"exportWAV",value:function(t,e){if(e=e||this.config.mimeType,t=t||this.config.callback,!t)throw new Error("Callback not set");this.callbacks.exportWAV.push(t),this.worker.postMessage({command:"exportWAV",type:e})}}]),t}();u.forceDownload=function(t,e){var n=document.createElement("a");n.style="display: none",document.body.appendChild(n);var o=window.URL.createObjectURL(t);n.href=o,n.download=e,n.click(),window.URL.revokeObjectURL(o),document.body.removeChild(n)},e.default=u},b9e1:function(t,e,n){},c782:function(t,e,n){t.exports=n("5c3d")}}]);
//# sourceMappingURL=chunk-1cb0.d6651305.js.map